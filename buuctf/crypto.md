# Crypto

## MD5

> 题解

1. 使用在线[cmd5](https://www.cmd5.com/)工具，字符串查找

> flag{admin1}

## URL编码

> 题解

1. URL解码

> flag{and 1=1}

## 一眼就解密

> 题解

1. base64解码

> flag{THE_FLAG_OF_THIS_STRING}

## 摩丝

> 题解

1. 摩斯密码解码，转成大写

> flag{ILOVEYOU}

## 变异凯撒

> 题解

1. 密文前五位ascii与格式相差为5，6，7，8，9，写脚本

> flag{Caesar_variation}

## Quoted-printable

> 题解

1. 使用在线[Quoted-printable](http://www.mxcz.net/tools/QuotedPrintable.aspx)解密

> flag{那你也很棒哦}

## password

> 题解

1. 姓名每个字的首字母，加上出生时间

> flag{zs19900315}

## 伪加密

> 题解

1. winhex打开，09->00

> flag{Adm1N-B2G-kU-SZIP}

## RSA

> 题解

```python
import gmpy2

p = 473398607161
q = 4511491
e = 17

d = int(gmpy2.invert(e, (p - 1) * (q - 1)))
print(d)
```

> flag{125631357777427553}

## 丢失的MD5

> 题解

1. 运行题目脚本，拿到flag

> flag{e9032994dabac08080091151380478a2}

## 篱笆墙的影子

> 题解

1. 栅栏密码

> flag{wethinkwehavetheflag}

## Alice与Bob

> 题解

1. [分解素数](http://www.factordb.com/index.php)
2. [md5加密](https://www.cmd5.com/)

> flag{d450209323a847c8d01c6be47c81811a}

## Windows系统密码

> 题解

1. john --show --format=LM pass.hash

> flag{good-luck}

## rsarsa

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes


def rsa_pqec(p: int, q: int, e: int, c: int) -> str:
    """解密
    """

    n = p * q
    d = int(gmpy2.invert(e, n - (p + q) + 1))

    return long_to_bytes(pow(c, d, n)), pow(c, d, n)
```

> flag{5577446633554466577768879988}

## 大帝的密码武器

1. 题解

```python
# 1. 凯撒密码爆破，得到有意思的单词
# 2. 拿到offset=13，加密明文
```

> flag{PbzrPuvan}

## 凯撒?替换?呵呵!

> 题解

1. https://quipqiup.com/

> flag{substitutioncipherdecryptionisalwayseasyjustlikeapieceofcake}

## RSA1

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes


def rsa_pqdpdqc(p: int, q: int, dp: int, dq: int, c: int) -> tuple:
    """解密
    """

    n = p * q
    phin = (p - 1) * (q - 1)
    dd = gmpy2.gcd(p - 1, q - 1)
    d = (dp - dq) // dd * gmpy2.invert((q - 1) // dd, (p - 1) // dd) * (q - 1) + dq
    m = gmpy2.powmod(c, d, n)

    return long_to_bytes(m), m
```

> flag{W31c0m3_70_Ch1n470wn}

## 信息化时代的步伐

> 题解

1. [电报码，选择中文，数字代码](https://www.qqxiuzi.cn/bianma/dianbao.php)

> flag{计算机要从娃娃抓起}

## RSA3

> 题解

1. 共模攻击

```python
import gmpy2
from Crypto.Util.number import long_to_bytes


def common_mode_attack(e1: int, e2: int, n: int, c1: int, c2: int) -> int:
    """Common mode attack
    """

    offset = 0

    gcd, s, t = gmpy2.gcdext(e1, e2)

    if s < 0:
        s = -s
        c1 = gmpy2.invert(c1, n)

    if t < 0:
        t = -t
        c2 = gmpy2.invert(c2, n)

    return (gmpy2.powmod(c1, s, n) * gmpy2.powmod(c2, t, n)) % n

m = common_mode_attack(e1, e2, n, c1, c2)
print(bytes.fromhex(hex(m)[2:]))
```

> flag{49d91077a1abcb14f1a9d546c80be9ef}

## old-fashion

> 题解

1. https://quipqiup.com/

> flag{n1_2hen-d3_hu1-mi-ma_a}

## 萌萌哒的八戒

> 题解

1. 猪圈密码

> flag{whenthepigwanttoeat}

## [AFCTF2018]Morse

> 题解

1. 摩斯密码解密，Hex字符串转ASCII字符串

> flag{1s't_s0_345y}

## 权限获得第一步

> 题解

1. 用在线cmd5解密F4AD50F57683D4260DFD48AA351A17A8

> flag{3617656}

## RSA2

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes


def rsa_nedp(n: int, dp: int, e: int, c: int) -> tuple:
    """解密

    dp = d % (p - 1)

    c = m ^ e mode n
    m = c ^ d mode n

    """

    d = 0

    for i in range(1, e):
        if (dp * e - 1) % i == 0:
            if n % (((dp * e - 1) // i) + 1) == 0:
                p = ((dp * e - 1) // i) + 1
                q = n // (((dp * e - 1) // i) + 1)
                phi = (p - 1) * (q - 1)
                d = gmpy2.invert(e, phi) % phi

    m = gmpy2.powmod(c, d, n)
    return long_to_bytes(m), m
```

> flag{wow_leaking_dp_breaks_rsa?_98924743502}

## robomunication

> 题解

1. b替换成“.”,p替换成“-”
2. 摩斯解密

> flag{BOOPBEEP}

## RSA

> 题解

1. [提取公钥(e,n)](http://tool.chacuo.net/cryptrsakeyparse)

```python
e = 65537
n = 86934482296048119190666062003494800588905656017203025617216654058378322103517
```
2. [传入n获取p和q](http://www.factordb.com/index.php)

```python
p = 285960468890451637935629440372639283459
q = 304008741604601924494328155975272418463
```

3. 解密脚本

```python
import gmpy2
from Crypto.Util.number import long_to_bytes

e = 65537
n = 86934482296048119190666062003494800588905656017203025617216654058378322103517
p = 285960468890451637935629440372639283459
q = 304008741604601924494328155975272418463


def rsa_pqec(p: int, q: int, e: int, c: int) -> tuple:
    """解密
    """

    n = p * q
    d = int(gmpy2.invert(e, n - (p + q) + 1))
    m = pow(c, d, n)

    return long_to_bytes(m), m

if __name__ == "__main__":
    with open("flag.enc", "rb") as f:
        c = int.from_bytes(f.read(), byteorder="big")
        print(rsa_pqec(p, q, e, c))
```

> flag{decrypt_256}

## 异性相吸

> 知识：XOR

> 题解

```python
s = ""

with open("key.txt", "rb") as f1:
    with open("密文.txt", "rb") as f2:
        str1 = f1.read()
        str2 = f2.read()

        for i in range(len(str1)):
            s += chr(str1[i] ^ str2[i])

print(s)
```

> flag{ea1bc0988992276b7f95b54a7435e89e}

## 世上无难事

> 知识点：词频分析

> 题解

1. [quipquip](https://quipqiup.com/)在线解析

> flag{640e11012805f211b0ab24ff02a1ed09}

## 传感器

> 知识点: 曼切斯特编码

> 题解

```python
import textwrap

# 1. 曼切斯特编码，高->低(1), 低->高(0)
# 2. 差分曼切斯特编码，无跳变(1), 有跳变(0)


s = "5555555595555A65556AA696AA6666666955"
ss = ""

# 从右往左看
# 5 --> 0101 --> 11
# 6 --> 0110 --> 10
# 9 --> 1001 --> 01
# A --> 1010 --> 00

for v in s:
    ss += bin(int(v, 16))[2:].zfill(4)

ss = "".join(["1" if v == "01" else "0" for v in textwrap.wrap(ss, 2)])
ss = "".join([hex(int(v[::-1], 2))[2:] for v in textwrap.wrap(ss, 8)])

print("flag{" + ss.upper() + "}")
```

> flag{FFFFFED31F645055F9}

## 还原大师

> 知识点：MD5加密暴力破解

> 题解

```python
# -*- coding: utf-8 -*-
# @Author: JanKinCai
# @Date:   2020-03-18 22:44:25
# @Last Modified by:   JanKinCai
# @Last Modified time: 2020-03-28 16:29:39
import string
import hashlib

# ?表示大写字母
s = "TASC{}O3RJMV{}WDJKX{}ZM"
# E903???4DAB????08?????51?80??8A?
# 知识点：MD5加密暴力破解


def md5_crack(s: str, vaild: str) -> str:
    """爆破MD5
    """

    for v1 in string.ascii_uppercase:
        for v2 in string.ascii_uppercase:
            for v3 in string.ascii_uppercase:
                ss = s.format(v1, v2, v3)
                ss = hashlib.md5(ss.encode("utf-8")).hexdigest().upper()
                
                if ss.startswith(vaild):
                    return ss


print(md5_crack(s, "E903"))
```

> flag{E9032994DABAC08080091151380478A2}

## RSAROLL

> 知识点：RSA加密/解密，分解p和q

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes

e = 19
n = 920139713
# 分解p和q：http://www.factordb.com/index.php?query=920139713
p = 18443
q = 49891

# (d * e) mod ((p - 1) * (q - 1)) = 1
# c = m ^ e mode n
# m = c ^ d mode n

d = int(gmpy2.invert(e, (p - 1) * (q - 1)))

m = ""

with open("data.txt", "rb") as f:
    f.readline()
    f.readline()

    while 1:
        ss = f.readline()

        if not ss:
            break
        c = int(ss.decode().replace("\n", ""))
        m += chr(gmpy2.powmod(c, d, n))

print(m)
```

> flag{13212je2ue28fy71w8u87y31r78eu1e2}

## RSA2

> 知识点：RSA wiener attack

> 题解

1. 通过这个脚本``https://github.com/pablocelayes/rsa-wiener-attack/blob/master/RSAwienerHacker.py``拿到d

> flag{47bf28da384590448e0b0d23909a25a4}

## Cipher

> 知识点：Playfair加密/解密

> 题解

1. Key为Playfair, 解密地址http://rumkin.com/tools/cipher/playfair.php

> flag{itisnotaproblemhavefun}

## Dangerous RSA

> 知识点：[低指数攻击](https://xz.aliyun.com/t/2731#toc-6)

> 题解

```python
import gmpy2

c = # ...
n = # ...
e = 3

k = 0

while 1:
    m, b = gmpy2.iroot(c + k * n, 3)
    if b == 1:
        print(bytes.fromhex(hex(m)[2:]))
        break
    k += 1
```

> flag{25df8caf006ee5db94d48144c33b2c3b}

## 达芬奇密码

> 知识点：移位

> 题解

```python
# S1和S2长度相同，对S1排序并排序S2
s1 = "1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711"
s1 = s1.split(" ")
s2 = "36968853882116725547342176952286"

print("flag{" + "".join([v for _, v in sorted(zip(s1, s2), key=lambda v: int(v[0]))]) + "}")
```

> flag{37995588256861228614165223347687}

## rot

> 知识点：移位(ROT13)

> 题解

1. [Rot13]解密

```
FLAG-I`-flagkp2k88kp2k84kp2k84kp2k84ykp2k80hikp2k86a{bak7syc|myikp2k80ykp2k83ek7skp2k86yg||dyYYYYkp2k8nk17MDOT@ReNc@O?R=Se>O=>RPS?=aac@Q>S=cbc
```

``表示看不懂``


[Rot13]: https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php

## RSA5

> 知识点：低指数广播攻击

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes


nlist = []
clist = []
e = 0


def rsa_leb_attack(c: list, n: list, e: int) -> bytes:
    """低指数广播攻击

    知识点：公约数分解n
    """

    for i in range(len(n) - 1):
        for j in range(i + 1, len(n)):
            p = gmpy2.gcd(n[i], n[j])
            if p != 1:
                q = int(n[i] // p)
                d = gmpy2.invert(e, (p - 1) * (q - 1))
                return long_to_bytes(gmpy2.powmod(c[i], d, n[i]))


fmt = lambda v: int(v.split(b"=")[-1].replace(b" ", b"").rstrip(b"\n"))


with open("1.txt", "rb") as f:
    ss = f.readlines()
    for v in ss:
        if b"===" in v:
            continue

        if b"c" in v:
            clist.append(fmt(v))
        elif b"n" in v:
            nlist.append(fmt(v))
        elif b"e" in v:
            e = fmt(v)

print(rsa_leb_attack(clist, nlist, e))
```

> flag{abdcbe5fd94e23b3de429223ab9c2fdf}

## basic rsa

> 知识点：RSA解密

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes

p = 262248800182277040650192055439906580479
q = 262854994239322828547925595487519915551
e = 65533
n = p*q
c = 27565231154623519221597938803435789010285480123476977081867877272451638645710

# 先求d，再解密
d = gmpy2.invert(e, (p - 1) * (q - 1))
m = gmpy2.powmod(c, d, n)
print(long_to_bytes(m))
```

> flag{B4by_Rs4}

## bbbbbbrsa

> 知识点：RSA解密，爆破e，base64解密

> 题解

```python
# -*- coding: utf-8 -*-
# @Author: JanKinCai
# @Date:   2020-03-15 02:13:05
# @Last Modified by:   JanKinCai
# @Last Modified time: 2020-03-29 19:10:49
import base64
import random

import gmpy2
from Crypto.Util.number import long_to_bytes


p = 177077389675257695042507998165006460849
n = 37421829509887796274897162249367329400988647145613325367337968063341372726061
q = n // p
c = b"==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM"
# 先反向，再base64解码
c = int(base64.b64decode(c[::-1]))

# e = random.randint(50000, 70000)
# 爆破e
for e in range(50000, 70000):
    if gmpy2.gcd(e, (p - 1) * (q - 1)) == 1:
        d = gmpy2.invert(e, (p - 1) * (q - 1))
        m = long_to_bytes(gmpy2.powmod(c, d, n))
        
        if b"flag{" in m:
            print(m)
```

> flag{rs4_1s_s1mpl3!#}

## [GUET-CTF2019]BabyRSA

> 知识点：简单数学，求 p * q

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes

# 由题已知
c = 0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a
e = 0xe6b1bee47bd63f615c7d0a43c529d219
d = 0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5
# p + q
pq1 = 0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea
# (p + 1) * (q + 1) = pq + p + q + 1 
pq2 = 0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740

# 求解p * q, n = pq2 - 1 - pq1
n = pq2 - 1 - (pq1)
m = gmpy2.powmod(c, d, n)
m = long_to_bytes(m)
print(m)
```

> flag{cc7490e-78ab-11e9-b422-8ba97e5da1fd}

## [GXYCTF2019]CheckIn

> 知识点：Base64、Rot47

> 题解

1. base64解码``v)*L*_F0<}@H0>F49023@FE0#@EN``
2. 发现``GXY{}``, offset=47, Rot47解密

```python
def rot47(s: bytes) -> bytes:
    """Rot47 Decode/Encode

    Args:
        param s (bytes): Value
    
    Returns:
        bytes
    """

    strs = [chr(v + 47 - 127 + 33 if v + 47 > 126 else v + 47) for v in s]

    return "".join(strs).encode()


print(rot47(b"v)*L*_F0<}@H0>F49023@FE0#@EN"))
# GXY{Y0u_kNow_much_about_Rot}
```

> flag{Y0u_kNow_much_about_Rot}

## 一张谍报

> 知识点：简单密码替换

> 题解

```python
# s3能对应到s2，所以s3对应s2的索引取出s1文字
s1 = "今天上午，朝歌区梆子公司决定，在每天三更天不亮免费在各大小区门口设卡为全城提供二次震耳欲聋的敲更提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的符号是前进。为此，全区老人都蹲在该公司东边树丛合力抵制，不给公司人员放行，场面混乱。李罗鹰住进朝歌区五十年了，人称老鹰头，几年孙子李虎南刚从东北当猎户回来，每月还寄回来几块鼹鼠干。李罗鹰当年遇到的老婆是朝歌一枝花，所以李南虎是长得非常秀气的一个汉子。李罗鹰表示：无论梆子公司做的对错，反正不能打扰他孙子睡觉，子曰：‘睡觉乃人之常情’。梆子公司这是连菩萨睡觉都不放过啊。李南虎表示：梆子公司智商捉急，小心居民猴急跳墙！这三伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，更有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李南虎仍旧表示爷爷年纪大了，睡不好对身体不好。"
s2 = "喵天上午，汪歌区哞叽公司决定，在每天八哇天不全免费在各大小区门脑设卡为全城提供双次震耳欲聋的敲哇提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的编号是前进。为此，全区眠人都足在该公司流边草丛合力抵制，不给公司人员放行，场面混乱。李罗鸟住进汪歌区五十年了，人称眠鸟顶，几年孙叽李熬值刚从流北当屁户回来，每月还寄回来几块报信干。李罗鸟当年遇到的眠婆是汪歌一枝花，所以李值熬是长得非常秀气的一个汉叽。李罗鸟表示：无论哞叽公司做的对错，反正不能打扰他孙叽睡觉，叽叶：‘睡觉乃人之常情’。哞叽公司这是连衣服睡觉都不放过啊。李值熬表示：哞叽公司智商捉急，小心居民猴急跳墙！这八伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，哇有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李值熬仍旧表示爷爷年纪大了，睡不好对身体不好。"
s3 = "喵汪哞叽双哇顶，眠鸟足屁流脑，八哇报信断流脑全叽，眠鸟进北脑上草，八枝遇孙叽，孙叽对熬编叶：值天衣服放鸟捉猴顶。鸟对：北汪罗汉伏熬乱天门。合编放行，卡编扯呼。人离烧草，报信归洞，孙叽找爷爷。"

res = ""

for i in range(len(s3)):
    for j in range(len(s2)):
        if s3[i] == strs2[j]:
            res += s1[j]
            break
print(res)
```

> flag{南天菩萨放鹰捉猴头}

## 这是什么

1. winhex打开文件，复制由``[]()``等字符组成的js代码
2. 打开浏览器F12, Console运行

> flag{a0448fd730b62c13ca80200c4529daa2}

## yxx

> 知识点：异或

> 题解

```python
s = ""

with open("密文.txt", "rb") as f:
    with open("明文.txt", "rb") as f1:
        s1 = f.read()
        s2 = f1.read()

        for i in range(len(s1)):
            s += chr(s1[i] ^ s2[i])

print(s)
# flag:nctf{xor_xor_xor_biubiubiu}
```

> flag{xor_xor_xor_biubiubiu}

## 鸡藕椒盐味

> 知识点：奇偶检验，纠错

```python
import hashlib
# 海明校验码纠错
print(hashlib.md5(b"110110100000").hexdigest())
```

> flag{d14084c7ceca6359eaac6df3c234dd3b}

## EasyProgram

> 知识点：代码阅读，编程

> 题解

```python
with open("file.txt", "rb") as f:
    ms = f.read()

key = "whoami"
s = list(range(256))
t = [key[i % len(key)] for i in range(256)]

j = 0

for i in range(256):
    j = (j + s[i] + ord(t[i])) % 256
    s[i], s[j] = s[j], s[i]

ss = ""
j = 0
i = 0

for m in range(38):
    i = (i + 1) % 256
    j = (j + s[i]) % 256
    s[i], s[j] = s[j], s[i]
    # 原题这行代码错误 set x:(s[i] + (s[j]mod(256))mod(256)) 应该改成 set x:(s[i] + (s[j]mod(256)))mod(256)
    x = (s[i] + (s[j] % 256)) % 256
    ss += chr(ms[m] ^ s[x])

print(ss)
```

> flag{f238yu28323uf28u2yef2ud8uf289euf}

## [AFCTF2018]你能看出这是什么加密么

> 知识点：RSA解密

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes

p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f
q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061
e=0x10001
c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6

d = gmpy2.invert(e, (p - 1) * (q - 1))
m = gmpy2.powmod(c, d, p * q)
m = long_to_bytes(m)
print(m)
```

> flag{R54_|5_$0_$imp13}

## [AFCTF2018]Vigenère

> 知识点：维吉密码爆破

密钥：csuwangjiang

> flag{Whooooooo_U_Gotcha!}

## [AFCTF2018]BASE

> 知识点：Base64/32/16

> 题解

```python
import base64


with open("flag_encode.txt",'rb') as f:
    ss = f.read()

while 1:
    try:
        ss = base64.b32decode(ss).decode()
    except Exception:
        try:
            ss = base64.b64decode(ss).decode()
        except Exception:
            try:
                ss = base64.b16decode(ss).decode()
            except Exception:
                print(ss)
                break

# afctf{U_5h0u1d_Us3_T00l5}
```

> flag{U_5h0u1d_Us3_T00l5}

## [AFCTF2018]Single

> 知识点：词频

> 题解

1. https://quipqiup.com/

> flag{Oh_U_found_it_nice_tRy}

## MagicNum

> 知识点：浮点数转ASCII码

```python
import struct


with open("where_is_flag.txt", "rb") as f:
    ss = f.read().decode().split("\r\n")


dd = b"".join([struct.pack("f", float(v)) for v in ss if v])
print(dd)
# afctf{sec_is_everywhere}
```

> flag{sec_is_everywhere}

## [HDCTF2019]together

> 知识点：共模攻击

> 题解

1. openssl rsa -pubin -text -modulus -in warmup -in pubkey1.pem
2. openssl rsa -pubin -text -modulus -in warmup -in pubkey2.pem
3. base64解密myflag1和myflag2

```python
import gmpy2
from Crypto.Util.number import long_to_bytes


e1 = 2333
e2 = 23333
n = 0x75A8B8AA2AD2950E9AED4BE34618DFBEABB8CBA832685CC94F45173330100624846CCF90F3C2DB75BA5AF4B39CAEF1175AB9F898794EAC6082A4F766F7CB280B16F6980B38DDA811761324D619513B3CBE65877ACF51FC70405A8347C121207E71F8E6FCAE39647ED2231D306DD53849257BC306E997A502867012249D1691F5DC11D6AF06539F3F808939343DDE09301A761AE12C1C969076C502BC5A971E10ABCB366547BC94373F37A57DDC43858DB29BAAAAAD0E6867885EA3757403008C164E9C7AFA39B3C65089A151DDD8C06C64271086F9255ADB8ACF82182F8FA252930A187961635BC2A85C761330F85C896314B3FDAE4EFEF7E0A8C93B8854BFC3
c1 = b'Gsh\xcb\xaa\xf7X\xb2-\xca\xd0&o\x81f\x1cL\xa0\xa2)npA\x19l\xefYa|y$\xdd7\x1c\xdaA,<{}wv~_\x94/\x9f\xb5\xd5\x10\xac\xff-*\x951\x94Ee\x83\xb4n\xbax\xd2\xf3\x1b\x03i\x00\xa8\x95\x8f\xa2;F\xd5\t\x97c\xdc\x9bso\x15\xe0\x05\xc0\x8fT\xb1TD\xca\x1e\xf3!^\xac#\xd6O\xf2_\xf6\x19P\xe8\xac\xb03\xe5B\xd6\xf9\xfd\x0e \xd1\xa1&ff\xf0R\xffh9\xe5}1%\x85\x0f;,\xf8\x9cZ\x95\xd8\xa0\xcbr\xaf\xa5\xab\xc62\xba:{g\xf0\x1a\x82\xb7A#C\xb4\xde]\x98q \x7fUL\xf5\xa3\x0ea]\x98\xea\x9a\xa9\xd5HO\xe2\xd9zd\xe0,\xd1\x12\xc0\xceg\x9f\x889Kv\x85\x0c\\#\xd5\x88\x83b]?\xfb\xc7\xad\xbc\xa7\xce\xad\xfa\n;\x04t\x0b\x1b\x11\x1d\xa80uE\x13\x11/\x04pr\xe60`\xb1\n@\xd9\x9ft\xb3\x9a`:5\xbd\xe5\x80\xb7\x92\x80o\x0f\xd4'
c1 = int.from_bytes(c1, "big")
c2 = b';\xea\xd1\tr7i0z?Z\xd8 \xe3\xd4u\xa9T\xa7\xab\xa3\xa7\x01*\xe0\x8d\xb4\n\x85\x80\xf8r\x0b\xf3\x1cF\xb6\xa6:7\x98)\xafH.f\xffY\x80\xe1\x000Y\xc1\xc4\xea\x8cuSg\x07\xd1\xa0\x9e\x19\x97\xb6\xddY[\'O\xa8\x87\x07\xbeW\xf0\xa5\xdf\xcb\xc9\xdd\x17J5\xe7\x8d\xac\xf7?{\xceB\xf4{\xd5\xc0\xff\xb9|\x81\x03E\xcf\xcei\xd3 \xc8\x04\x86\xe1\x89TY\xbc\x9a)\xf4/\xfd\xaa#\xbc \xfd\x9e\xf0\xd7\xee&:h\xba\xe7\x92H]\xe0\xa2\x1bm\xee\x90;\xfa\x97\xd6\xd9\xba\xa7\xc6\xbd`\x9a\xd4\xa2\x97X3\xf7\xd6r\xdb\xa7FM\xda\x86\xd4\xb3\xa8\xc4\x01\xadjU6\x97\xe8\xce\x0c\xcb\xeb$\xb3\xed\x15\xbcp\x13\xac\x05.\n\xb9\x8c\xc1Q"\xbe\xa2\t\xfet\xba\xcaa\x95\x11\x13z:\x19\xf3\xca\xbdz\xf2I\xc4\x04\xa3\x95\x8fA@;\x1d\xd8-\xfai0\xcf\x97l\xe1\x87z\xa7J%\x12\xe92\xfa\x85\\3\x06@\x89\xd3\xdf'
c2 = int.from_bytes(c2, "big")



gcd, s, t = gmpy2.gcdext(e1, e2)

if s < 0:
    s = -s
    c1 = gmpy2.invert(c1, n)

if t < 0:
    t = -t
    c2 = gmpy2.invert(c2, n)

m = (gmpy2.powmod(c1, s, n) * gmpy2.powmod(c2, t, n)) % n

print(long_to_bytes(m))
# flag{23re_SDxF_y78hu_5rFgS}
```

> flag{23re_SDxF_y78hu_5rFgS}

## 四面八方

> 知识点：四方密码

> 题解

https://www.dcode.fr/four-squares-cipher

```
GRID 1(TOP LEFT): ABCDEFGHIJKLMNOPRSTUVWXYZ
GRID 2(TOP RIGHT): SECURITYABDFGHJKLMNOPVWXZ
GRID 3(BOTTOM LEFT): INFORMATBCDEGHJKLPSUVWXYZ
GRID 4(BOTTOM RIGHT): ABCDEFGHIJKLMNOPRSTUVWXYZ
```

> flag{youngandsuccessful}

## RSA & what

> 知识点：共模攻击、base64隐写

```python
import base64
import textwrap
import string

import gmpy2
from Crypto.Util.number import long_to_bytes


e1 = 1697
e2 = 599
n = 785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147
c1 = [
    412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650,
    494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248,
    152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335,
    79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920,
    123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984,
    36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295,
]
c2 = [
    592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186,
    373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176,
    527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605,
    8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580,
    205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819,
    271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207,
]


base64_code = "".join([
    string.ascii_uppercase,
    string.ascii_lowercase,
    string.digits,
    "+/",
])


def base64_stego(path: str) -> str:
    """Base64 stego

    Args:
        param path (str): File path.

    Returns:
        str: flag
    """

    stegolist = []

    with open(path, mode="r", encoding="utf-8") as f:
        for i, bs in enumerate(f.read().split("\n"), 1):
            stegov = base64_stego_decode(bs)

            if stegov is not None:
                stegolist.append(stegov)

    flag = "".join([chr(int(bit, 2)) for bit in textwrap.wrap("".join(stegolist), 8) if int(bit) != 0 ])

    return flag


def base64_stego_decode(vstr: str) -> str:
    """Base64 stego decode
    
    Args:
        param vstr (str): base64 encode string.

    Returns:
        str: base64 decode stego bits
    """

    vstr += "=" * min((len(vstr) % 4), 2)
    count = vstr.count("=")

    if count < 1:
        return None

    bits = 0x0f if count == 2 else 0x03

    v = base64_code.find(vstr.replace("=", "")[-1]) & bits
    return bin(v)[2:].zfill(count * 2)


def rsa_ee_n_cc(e1: int, e2: int, n: int, c1: int, c2: int) -> bytes:
    """RSA common modulus attack
    """

    gcd, s, t = gmpy2.gcdext(e1, e2)

    if s < 0:
        s = -s
        c1 = gmpy2.invert(c1, n)

    if t < 0:
        t = -t
        c2 = gmpy2.invert(c2, n)

    m = (gmpy2.powmod(c1, s, n) * gmpy2.powmod(c2, t, n)) % n

    return long_to_bytes(m)


def rsa_ee_n_ccs(e1: int, e2: int, n: int, c1: list, c2: list) -> bytes:
    """RSA common modulus attack
    """

    return b"".join([rsa_ee_n_cc(e1, e2, n, cc1, cc2) for cc1, cc2 in zip(c1, c2)])


m = rsa_ee_n_ccs(e1=e1, e2=e2, n=n, c1=c1, c2=c2)

with open("base64.txt", "wb") as f:
    f.write(m)

print("flag{" + base64_stego("base64.txt") + "}")
```

> flag{7c86d8f7d6de33a87f7f9d6b005ce640}

## RSA4

> 知识点：中国剩余定理(CRT)

> 题解

```python
import gmpy2
from Crypto.Util.number import long_to_bytes
from functools import reduce

# 5进制转换十进制
N1 = '331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004'
c1 = '310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243'
N1, c1 = map(lambda x: int(x, base=5), (N1, c1))

N2 = '302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114'
c2 = '112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344'
N2, c2 = map(lambda x: int(x, base=5), (N2, c2))

N3 = '332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323'
c3 = '10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242'
N3, c3 = map(lambda x: int(x, base=5), (N3, c3))

e = 3
n = [N1, N2, N3]
c = [c1, c2, c3]

def rsa_crt_cs_ns_e(c: list, n: list, e: int) -> bytes:
    """RSA CRT
    """

    lcm = reduce(lambda n1, n2: n1 * n2, n)

    s = 0
    for i in range(len(c)):
        s += c[i] * lcm // n[i] * gmpy2.invert(lcm // n[i], n[i])

    ms = gmpy2.iroot(s % lcm, e)

    if ms[1]:
        return long_to_bytes(ms[0])

    return None


print(rsa_crt_cs_ns_e(c=c, n=n, e=e))
# noxCTF{D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!}
```

> {D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!}
