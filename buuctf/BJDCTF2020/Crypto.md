# Crypto

## 签到-y1ng

> 题解

1. base64

> BJD{W3lc0me_T0_BJDCTF}

## 老文盲了

> 题解

1. 拼音查询

> BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}

## cat_flag

> 题解

1. 每行8bit对应ASCII码

> BJD{M!a0~}

## 灵能精通-y1ng

> 题解

1. 变种猪圈密码

> flag{IMKNIGHTSTEMPLAR}

## 燕言燕语-y1ng

> 题解

1. 转成ASCII码
2. 维基亚密码解密，密钥yanzi

> BJD{yanzi_jiushige_shabi}

## Y1nglish-y1ng

> 题解

1. [在线解密](https://quipqiup.com/)
2. Cr4cy --> Cr4ck

> BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}

## rsa0

> 题解

```python
import gmpy2
from Crypto.Util.number import *

# a = p + q
# b = p - q
# c = c
# e = e

n = (a**2 - b**2) // 4
d = int(gmpy2.invert(e, n - a + 1))
print(long_to_bytes(pow(c, d, n)))
```

> flag{3b5f314b-7efc-4bd9-9f47-bf964ee7bd81}

## rsa1

> 题解

```python
import gmpy2
from Crypto.Util.number import *


# (p - q)^2 = p^2 + q^2 - 2pq ===> b^2 = a - 2n ===> n = (a - (b**2)) // 2
n = (a - (b**2)) // 2

a = # p^2 + q ^ 2
b = # p - q
c = # c
e = # e

# (p + q)^2 = p^2 + q^2 + 2pq
p_q = gmpy2.iroot(a + 2 * n, 2)[0]
# (p - 1) * (q - 1) = pq - (p + q) + 1
d = int(gmpy2.invert(e, n - p_q + 1))
p = pow(c, d, n)
print(long_to_bytes(p))
```

> flag{1b0ad21b-d258-480e-a816-938552486532}

## RSA

> 知识点：爆破e，分解n

> 题解

```python
import gmpy2
from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes

"""
c = m ^ e mode n
m = c ^ d mode n
"""

# m1 = flag
m2 = 294
m3 = bytes_to_long(b"BJD" * 32)

c1 = 12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120
c2 = 381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018
c3 = 979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721

# p1 = Random
# p2 = p1
# p3 = Random

# q1 = Random
# q2 = q1
# q3 = q1

# n1 = p1 * q1
n1 = 13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037
# n2 = p1 * q1
n2 = n1
# n3 = p3 * q1
n3 = 12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047

for i in range(100000):
    if gmpy2.powmod(m2, i, n2) == c2:
        e = i
        print(f"e={i}")
        break

p = gmpy2.gcd(n1, n3)
q1 = n1 // p
q2 = n3 // p

d = gmpy2.invert(e, (p - 1) * (q1 - 1))
m1 = gmpy2.powmod(c1, d, n1)
print(long_to_bytes(m1))
# BJD{p_is_common_divisor}
```

> flag{p_is_common_divisor}